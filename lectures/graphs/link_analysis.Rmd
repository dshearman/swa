% Graphs 2: Link Analysis
% Laurence A. F. Park
% March 22, 2005

```{r setup, include=FALSE}
opts_chunk$set(dev = 'pdf', fig.cap="")
library("igraph")
```


## Random Walk

A random walk is a traversal of some space, where we take $n$ steps (some
number of steps), and each step is decided randomly.

Examples of random walks in 1, 2, and 3 dimensional space can be seen at:
<http://en.wikipedia.org/wiki/Random_walk>


## Random Walk on a Graph

Random walks can be taken on graphs, where each step moves us to a
vertex and the edges of each vertex provide a path between vertices.

### Two random walks from $v_1$ of length 3
```{r, echo=FALSE, fig.width=1.5, fig.height=1.5}
g = graph.formula(A-B, A-C, A-D, B-E, B-D, C-D, C-E, C-F, D-F, F-G)
E(g)$color = "#AAAAAA"

E(g)[c(3,9,10)]$color = "#AA0000"
E(g)[c(1,4,6)]$color = "#0000AA"

par(mar = c(0,0,0,0))
V(g)$label.cex = 0.8
plot(g, vertex.label = c(expression("v"[1]),expression("v"[2]),expression("v"[3]),expression("v"[4]),
expression("v"[5]),expression("v"[6]),expression("v"[7])),
layout=layout.fruchterman.reingold, vertex.size = 35)
```

## Random Walk on a Graph and Probabilities

By taking a random walk of length 1, we choose an edge at random that
is connected to the current vertex and follow it. The probability of
following a particular edge is equal to $1/\text{degree}(v)$, where
$v$ is the staring vertex.

### Probability of arriving at vertex.
```{r, echo=FALSE, fig.width=1.5, fig.height=1.5}
g = graph.formula(A-B, A-C, A-D, A-E, B-D)

par(mar = c(0,0,0,0))
V(g)$label.cex = 0.8
plot(g, vertex.label = c(expression("v"[1]),expression("v"[2]),expression("v"[3]),expression("v"[4]),
expression("v"[5])),
layout=layout.fruchterman.reingold, vertex.size = 35)
```
After a random walk of length 1 beginning at $v_1$, the probability of arriving at $v_2$ is $1/4$.

## Random walk probability

### Problem 
```{r, echo=FALSE, fig.width=1.5, fig.height=1.5}
g = graph.formula(A-B, A-C, A-D, A-E, B-D)

par(mar = c(0,0,0,0))
V(g)$label.cex = 0.8
plot(g, vertex.label = c(expression("v"[1]),expression("v"[2]),expression("v"[3]),expression("v"[4]),
expression("v"[5])),
layout=layout.fruchterman.reingold, vertex.size = 35)
```
After a random walk of length 1:

- What is the probability of arriving at $v_3$, when beginning at $v_1$?
- What is the probability of arriving at $v_2$, when beginning at $v_4$?
- What is the probability of arriving at $v_5$, when beginning at $v_3$?


## State distribution

The state of a random walk is the vertex in which the walk has ended
on.  After a random walk of length $n$, there is a chance of being in
multiple states, where each state has a probability.

The collection of probabilities forms a distribution over the set of
states.

## State distribution example
```{r, echo=FALSE, fig.width=1.5, fig.height=1.5}
g = graph.formula(A-B, A-C, A-D)

par(mar = c(0,0,0,0))
V(g)$label.cex = 0.8
plot(g, vertex.label = c(expression("v"[1]),expression("v"[2]),expression("v"[3]),expression("v"[4])),
layout=layout.fruchterman.reingold, vertex.size = 35)
```
After a random walk of length n, we have the state distribution:

\begin{center}
\begin{tabular}{lcccc}
\toprule
State       & $v_1$ & $v_2$ & $v_3$ & $v_4$ \\
\midrule
Probability (n = 1) & 0     & 1/3   & 1/3   & 1/3   \\
Probability (n = 2) & 1     & 0   & 0   & 0   \\
Probability (n = 3) & 0     & 1/3   & 1/3   & 1/3   \\
\bottomrule
\end{tabular}
\end{center}

