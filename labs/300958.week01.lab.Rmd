% Twitter and Facebook APIs 
% 300958 Social Web Analysis 
% Week 3 Lab

`r opts_chunk$set(prompt=TRUE, comment=NA)`
`r knit_hooks$set(source = function(x, options) paste("<pre lang='r'>", x, "</pre>", sep = ""))`

# R Basics

All of the lab sessions for 300958 Social Web Analysis will use R and
RStudio. If these two applications are not installed on the computer
you are using, download them from:

- R: [http://cran.csiro.au/](http://cran.csiro.au/)
- RStudio: [http://www.rstudio.com/ide/download/desktop](http://www.rstudio.com/ide/download/desktop)

Install R, then Rstudio.

Once they are installed, open RStudio and say hello.
```{r}
print("Hello world!")
```

# Accessing Twitter

To access the Twitter API, we must first load the twitteR library.

`r library("twitteR")`
```{r}
library("twitteR")
```

Register an application at Twitter
https://dev.twitter.com/apps
This will provides you with a consumer key and consumer secret.

We then need to set up the OAuth session details.

```{.r}
cred <- OAuthFactory$new(consumerKey="insert here",
     consumerSecret="insert here",
     requestURL="https://api.twitter.com/oauth/request_token",
     accessURL="https://api.twitter.com/oauth/access_token",
     authURL="https://api.twitter.com/oauth/authorize")
cred$handshake()
```

Once the handshake is performed, R will ask you to visit a URL to get
an access code from Twitter. Get this code and provide it to R.
Once the handshake is done, we can save the credential information
and use it later, without having go directly to Twitter again.

```{.r}
save(cred, file="twitter.Rdata")
```

When we want to access Twitter in another session, we simply load and
register the credentials:
```{.r}
load("twitter.Rdata")
registerTwitterOAuth(cred)
```


```{.r}
x = searchTwitter('kevin bacon')
z = twListToDF(x)


library(tm) #load text mining library
setwd('F:/My Documents/My texts') #sets R's working directory to near where my files are
a  <-Corpus(DirSource("/My Documents/My texts"), readerControl = list(language="lat")) #specifies the exact folder where my text file(s) is for analysis with tm.
summary(a)  #check what went in
a <- tm_map(a, removeNumbers)
a <- tm_map(a, removePunctuation)
a <- tm_map(a , stripWhitespace)
a <- tm_map(a, tolower)
a <- tm_map(a, removeWords, stopwords("english")) # this stopword file is at C:\Users\[username]\Documents\R\win-library\2.13\tm\stopwords 
a <- tm_map(a, stemDocument, language = "english")
adtm <-DocumentTermMatrix(a) 
adtm <- removeSparseTerms(adtm, 0.75)


cz = Corpus(VectorSource(z$text))
tdm <- TermDocumentMatrix(cz, control = list(removePunctuation = TRUE, stopwords = TRUE, stem = TRUE))
tdm = weightTfIdf(tdm)
inspect(tdm)
tdm2 <- removeSparseTerms(tdm, sparse=0.95)
df <- as.data.frame(inspect(tdm2))
d = dist(df)
h = hclust(d)
rect.hclust(h, k=5, border="red")


cos.dissim <- function(x,y) {
	   x = as.numeric(x)
	   y = as.numeric(y)
	   return(1 - (x %*% y)/(sqrt(x %*% x)*sqrt(y %*% y)))
}

cos.sim <- function(x,y) {
	   x = as.numeric(x)
	   y = as.numeric(y)
	   return((x %*% y)/(sqrt(x %*% x)*sqrt(y %*% y)))
}

d = matrix(0, nrow(df), nrow(df))

for (a in 1:nrow(df)) {
    for (b in 1:nrow(df)) {
    	d[a,b] <- cos.dissim(df[a,],df[b,])
    }
}
rownames(d) <- rownames(df)

d = as.dist(d)
h = hclust(d)
plot(h)

```

http://files.meetup.com/1772780/Mining%20Twitter%20Using%20R.pdf

# Accessing Facebook

